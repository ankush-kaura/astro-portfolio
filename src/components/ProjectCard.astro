---
import { Card as ShadcnCard } from './ui/card'

const {
  as: Tag = 'a',
  class: className,
  href,
  heading,
  subheading,
  imagePath,
  altText,
} = Astro.props
---

<Tag href={href} class={`${className}`} data-project-title={heading} data-project-href={href}>
  <ShadcnCard
    className={`transfor-y-[-40%] align-start perspective-1200 group relative flex-none transform justify-start overflow-hidden shadow-lg transition duration-75 ease-in-out bg-white/10 backdrop-blur-lg border border-white/20 ${href ? 'cursor-pointer hover:border-primary hover:bg-white/20' : ''}`}
  >
    <img
       src={imagePath || '/me.png'}
       alt={altText}
       class="h-40 sm:h-44 md:h-48 w-full rounded-2xl rounded-bl-none rounded-br-none object-cover"
       loading="eager"
       onerror="this.src='/me.png'"
     />
    <div class="flex flex-col gap-y-1 sm:gap-y-0.5 px-4 sm:px-5 py-3 sm:py-4">
      <h1 class="text-base sm:text-lg font-medium line-clamp-2">{heading}</h1>
      <h2 class="text-sm sm:text-base text-muted-foreground line-clamp-3">{subheading.substring(0, 120) + "..."}</h2>
    </div>

    <slot />
  </ShadcnCard>
</Tag>

<script is:inline>
  // Track project card clicks
  document.addEventListener('click', (e) => {
    const target = e.target.closest ? e.target.closest('[data-project-title]') : null;
    if (target) {
      const title = target.getAttribute('data-project-title');
      const href = target.getAttribute('data-project-href');
      if (window.gtag) {
        window.gtag('event', 'project_click', {
          project_title: title,
          project_href: href,
        });
      }
    }
  });
</script>
